<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Cassandraå­¦ä¹ ç¬”è®° | è§‚æ²§æµ·</title><meta name="author" content="gcdd1993"><meta name="copyright" content="gcdd1993"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å‡†å¤‡æŒ‰ç…§Cassandraé›†ç¾¤éƒ¨ç½²æ­å»ºä¸¤å°æµ‹è¯•æœºï¼Œç¯å¢ƒä¿¡æ¯å¦‚ä¸‹ï¼š    åç§° IP æ•°æ®ä¸­å¿ƒåç§°    node-01 192.168.198.130 datacenter1   node-02 192.168.198.131 datacenter1    Keyspaceåˆ›å»ºKeyspace1cr"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.gcdd.top/p/60138/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//www.clarity.ms"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google_site_verification" content="4TnUW4QBD9r3V1askk209s95RT4rHJmAIQM4C4sSM_s"><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?458617f9908f57a266df7d9d95b0a7c8";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DQJWXD2MFH"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DQJWXD2MFH")</script><script>!function(t,e,n,c,a,i,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(i=e.createElement(c)).async=1,i.src="https://www.clarity.ms/tag/7wiuw8thfu",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(i,r)}(window,document,"clarity","script")</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"60KI5WFNCN",apiKey:"7228b85adc4cfd522742cce99720a046",indexName:"myblog",hits:{per_page:6},languages:{input_placeholder:"æœç´¢æ–‡ç« ",hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},localSearch:void 0,translate:{defaultEncoding:1,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç®€"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",dateSuffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#49b1f5",bgDark:"#2d3035",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js",buttonText:"åŠ è½½æ›´å¤š"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Cassandraå­¦ä¹ ç¬”è®°",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-08-30 12:52:53"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="è§‚æ²§æµ·" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/asserts/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">91</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">56</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">4</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E4%B8%80%E8%B5%B7%E8%96%85%E7%BE%8A%E6%AF%9B/"><i class="fa-fw fa fa-gift"></i> <span>ä¸€èµ·è–…ç¾Šæ¯›</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/"><i class="fa-fw fa fa-book"></i> <span>ä¸ªäººç¬”è®°</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/404.html"><i class="fa-fw fa fa-heartbeat"></i> <span>å…¬ç›Šå¯»äºº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="è§‚æ²§æµ·"><span class="site-name">è§‚æ²§æµ·</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E4%B8%80%E8%B5%B7%E8%96%85%E7%BE%8A%E6%AF%9B/"><i class="fa-fw fa fa-gift"></i> <span>ä¸€èµ·è–…ç¾Šæ¯›</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/"><i class="fa-fw fa fa-book"></i> <span>ä¸ªäººç¬”è®°</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/404.html"><i class="fa-fw fa fa-heartbeat"></i> <span>å…¬ç›Šå¯»äºº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Cassandraå­¦ä¹ ç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2019-05-22T07:42:04.000Z" title="å‘è¡¨äº 2019-05-22 15:42:04">2019-05-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-08-30T04:52:53.897Z" title="æ›´æ–°äº 2023-08-30 12:52:53">2023-08-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/">ä¸ªäººç¬”è®°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">4.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>21åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Cassandraå­¦ä¹ ç¬”è®°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><p>æŒ‰ç…§<a target="_blank" rel="noopener" href="https://gcdd1993.github.io/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E9%83%A8%E7%BD%B2%E7%AF%87%EF%BC%89/#more">Cassandraé›†ç¾¤éƒ¨ç½²</a>æ­å»ºä¸¤å°æµ‹è¯•æœºï¼Œç¯å¢ƒä¿¡æ¯å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>IP</th><th>æ•°æ®ä¸­å¿ƒåç§°</th></tr></thead><tbody><tr><td>node-01</td><td>192.168.198.130</td><td>datacenter1</td></tr><tr><td>node-02</td><td>192.168.198.131</td><td>datacenter1</td></tr></tbody></table><span id="more"></span><h1 id="Keyspace"><a href="#Keyspace" class="headerlink" title="Keyspace"></a>Keyspace</h1><h2 id="åˆ›å»ºKeyspace"><a href="#åˆ›å»ºKeyspace" class="headerlink" title="åˆ›å»ºKeyspace"></a>åˆ›å»ºKeyspace</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_keyspace_statement ::=  CREATE KEYSPACE [ IF NOT EXISTS ] keyspace_name WITH options</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">## ä½¿ç”¨SimpleStrategyå¤åˆ¶ç­–ç•¥</span><br><span class="line">CREATE KEYSPACE excelsior</span><br><span class="line">    WITH replication = &#123;&#x27;class&#x27;: &#x27;SimpleStrategy&#x27;, &#x27;replication_factor&#x27; : 3&#125;;</span><br><span class="line"></span><br><span class="line">## ä½¿ç”¨NetworkTopologyStrategyå¤åˆ¶ç­–ç•¥</span><br><span class="line"># 1. ç¡®è®¤åˆ†åŒºåç§°</span><br><span class="line">$ nodetool status</span><br><span class="line">Datacenter: datacenter1</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"># 2. ä½¿ç”¨NetworkTopologyStrategyå¤åˆ¶ç­–ç•¥åˆ›å»ºkeyspace</span><br><span class="line">CREATE KEYSPACE excalibur</span><br><span class="line">    WITH replication = &#123;&#x27;class&#x27;: &#x27;NetworkTopologyStrategy&#x27;, &#x27;DC1&#x27; : 1, &#x27;DC2&#x27; : 3&#125;</span><br><span class="line">    AND durable_writes = false;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨Keyspace"><a href="#ä½¿ç”¨Keyspace" class="headerlink" title="ä½¿ç”¨Keyspace"></a>ä½¿ç”¨Keyspace</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use_statement ::=  USE keyspace_name</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹Keyspaceï¼ˆreplication-factorï¼‰"><a href="#ä¿®æ”¹Keyspaceï¼ˆreplication-factorï¼‰" class="headerlink" title="ä¿®æ”¹Keyspaceï¼ˆreplication factorï¼‰"></a>ä¿®æ”¹Keyspaceï¼ˆreplication factorï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter_keyspace_statement ::=  ALTER KEYSPACE keyspace_name WITH options</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER KEYSPACE excelsior </span><br><span class="line">	WITH replication = &#123;&#x27;class&#x27;: &#x27;SimpleStrategy&#x27;, &#x27;replication_factor&#x27; : 4&#125;;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹Keyspace"><a href="#æŸ¥çœ‹Keyspace" class="headerlink" title="æŸ¥çœ‹Keyspace"></a>æŸ¥çœ‹Keyspace</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESCRIBE KEYSPACE &lt;keyspace name&gt;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¯¥è¯­å¥æŸ¥çœ‹åˆ›å»ºçš„é”®ç©ºé—´æ˜¯å¦æ­£ç¡®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DESCRIBE KEYSPACE excelsior;</span><br><span class="line"></span><br><span class="line">CREATE KEYSPACE excelsior WITH replication = &#123;&#x27;class&#x27;: &#x27;SimpleStrategy&#x27;, &#x27;replication_factor&#x27; : 3&#125; AND durable_writes = true;</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤Keyspace"><a href="#åˆ é™¤Keyspace" class="headerlink" title="åˆ é™¤Keyspace"></a>åˆ é™¤Keyspace</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop_keyspace_statement ::=  DROP KEYSPACE [ IF EXISTS ] keyspace_name</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DROP KEYSPACE excelsior;</span><br><span class="line">DESCRIBE excelsior;</span><br><span class="line"></span><br><span class="line">&#x27;excelsior&#x27; not found in keyspaces</span><br></pre></td></tr></table></figure><h1 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h1><h2 id="åˆ›å»ºTable"><a href="#åˆ›å»ºTable" class="headerlink" title="åˆ›å»ºTable"></a>åˆ›å»ºTable</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create_table_statement ::=  CREATE TABLE [ IF NOT EXISTS ] table_name</span><br><span class="line">                            &#x27;(&#x27;</span><br><span class="line">                                column_definition</span><br><span class="line">                                ( &#x27;,&#x27; column_definition )*</span><br><span class="line">                                [ &#x27;,&#x27; PRIMARY KEY &#x27;(&#x27; primary_key &#x27;)&#x27; ]</span><br><span class="line">                            &#x27;)&#x27; [ WITH table_options ]</span><br><span class="line">column_definition      ::=  column_name cql_type [ STATIC ] [ PRIMARY KEY]</span><br><span class="line">primary_key            ::=  partition_key [ &#x27;,&#x27; clustering_columns ]</span><br><span class="line">partition_key          ::=  column_name</span><br><span class="line">                            | &#x27;(&#x27; column_name ( &#x27;,&#x27; column_name )* &#x27;)&#x27;</span><br><span class="line">clustering_columns     ::=  column_name ( &#x27;,&#x27; column_name )*</span><br><span class="line">table_options          ::=  COMPACT STORAGE [ AND table_options ]</span><br><span class="line">                            | CLUSTERING ORDER BY &#x27;(&#x27; clustering_order &#x27;)&#x27; [ AND table_options ]</span><br><span class="line">                            | options</span><br><span class="line">clustering_order       ::=  column_name (ASC | DESC) ( &#x27;,&#x27; column_name (ASC | DESC) )*</span><br></pre></td></tr></table></figure><p>åˆ›å»ºTableå¿…é¡»æŒ‡å®šä¸»é”®ï¼Œä¸»é”®æ˜¯ç”¨äºåœ¨è¡¨ä¸­å”¯ä¸€æ ‡è¯†æŸä¸€è¡Œï¼Œå¯ä»¥æ˜¯ä¸€åˆ—æˆ–å¤šåˆ—ã€‚</p><p>ç¤ºä¾‹ï¼Œåœ¨<code>excelsior</code>é”®ç©ºé—´åˆ›å»ºä¸€å¼ åä¸º<code>excelsior_alt_stats</code> çš„è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE excelsior.excelsior_alt_stats (</span><br><span class="line">	id UUID PRIMARY KEY,</span><br><span class="line">	lastname text,</span><br><span class="line">	birthday timestamp,</span><br><span class="line">	nationality text,</span><br><span class="line">	weight text,</span><br><span class="line">	height text</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>cassandraè¿˜æ”¯æŒcollectionï¼ˆmap, set, æˆ–è€… listï¼‰ç±»å‹ä½œä¸ºåˆ—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE excelsior.whimsey ( </span><br><span class="line">    id UUID PRIMARY KEY, </span><br><span class="line">    lastname text, </span><br><span class="line">    excelsior_teams set&lt;text&gt;, </span><br><span class="line">    events list&lt;text&gt;, </span><br><span class="line">    teams map&lt;int,text&gt; </span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ç”šè‡³æ˜¯åµŒå¥—çš„å…ƒç»„ç±»å‹ï¼ˆtupleï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE excelsior.route (</span><br><span class="line">    race_id int, </span><br><span class="line">    race_name text, </span><br><span class="line">    point_id int, </span><br><span class="line">    lat_long tuple&lt;text, tuple&lt;float,float&gt;&gt;, </span><br><span class="line">    PRIMARY KEY (race_id, point_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ›´å¤šæ•°æ®ç±»å‹è¯·å‚é˜…ä¸‹ä¸€èŠ‚<a href="#Cassandra%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">Cassandraæ•°æ®ç»“æ„</a></p><h3 id="é™æ€åˆ—"><a href="#é™æ€åˆ—" class="headerlink" title="é™æ€åˆ—"></a>é™æ€åˆ—</h3><p>æŸäº›åˆ—å¯ä»¥åœ¨è¡¨å®šä¹‰ä¸­å£°æ˜ä¸ºSTATICã€‚é™æ€çš„åˆ—å°†ç”±å±äºåŒä¸€åˆ†åŒºï¼ˆå…·æœ‰ç›¸åŒåˆ†åŒºé”®ï¼‰çš„æ‰€æœ‰è¡Œâ€œå…±äº«â€ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE t (</span><br><span class="line">    pk int,</span><br><span class="line">    t int,</span><br><span class="line">    v text,</span><br><span class="line">    s text static,</span><br><span class="line">    PRIMARY KEY (pk, t)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO t (pk, t, v, s) VALUES (0, 0, &#x27;val0&#x27;, &#x27;static0&#x27;);</span><br><span class="line">INSERT INTO t (pk, t, v, s) VALUES (0, 1, &#x27;val1&#x27;, &#x27;static1&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM t;</span><br><span class="line">   pk | t | v      | s</span><br><span class="line">  ----+---+--------+-----------</span><br><span class="line">   0  | 0 | &#x27;val0&#x27; | &#x27;static1&#x27;</span><br><span class="line">   0  | 1 | &#x27;val1&#x27; | &#x27;static1&#x27;</span><br><span class="line">   </span><br><span class="line">## æ‰€æœ‰è®°å½•ä¸­çš„é™æ€åˆ—å°†æ°¸è¿œå±•ç¤ºæœ€åä¸€æ¬¡æ›´æ–°çš„å€¼   </span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹Table"><a href="#ä¿®æ”¹Table" class="headerlink" title="ä¿®æ”¹Table"></a>ä¿®æ”¹Table</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alter_table_statement   ::=  ALTER TABLE table_name alter_table_instruction</span><br><span class="line">alter_table_instruction ::=  ADD column_name cql_type ( &#x27;,&#x27; column_name cql_type )*</span><br><span class="line">                             | DROP column_name ( column_name )*</span><br><span class="line">                             | WITH options</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE addamsFamily ADD gravesite varchar;</span><br><span class="line"></span><br><span class="line">ALTER TABLE addamsFamily</span><br><span class="line">       WITH comment = &#x27;A most excellent and useful table&#x27;;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹Tableå¯ä»¥ï¼š</p><ol><li>å‘è¡¨ä¸­æ·»åŠ æ–°åˆ—ï¼ˆé€šè¿‡ADDæŒ‡ä»¤ï¼‰ã€‚è¯·æ³¨æ„ï¼Œæ— æ³•æ›´æ”¹è¡¨çš„ä¸»é”®ï¼Œå› æ­¤æ–°æ·»åŠ çš„åˆ—å°†ä¸ä¼šæˆä¸ºä¸»é”®çš„ä¸€éƒ¨åˆ†ã€‚</li><li>ä»è¡¨ä¸­åˆ é™¤åˆ—ã€‚è¿™ä¼šä¸¢å¼ƒåˆ—åŠå…¶æ‰€æœ‰å†…å®¹ã€‚</li><li>æ›´æ”¹ä¸€äº›è¡¨é€‰é¡¹ï¼ˆé€šè¿‡WITHæŒ‡ä»¤ï¼‰ã€‚æ”¯æŒçš„é€‰é¡¹ä¸åˆ›å»ºè¡¨æ—¶ç›¸åŒï¼ˆåœ¨åˆ›å»ºåæ— æ³•æ›´æ”¹çš„COMPACT STORAGEå’ŒCLUSTERING ORDERä¹‹å¤–ï¼‰ã€‚</li></ol><h2 id="åˆ é™¤Table"><a href="#åˆ é™¤Table" class="headerlink" title="åˆ é™¤Table"></a>åˆ é™¤Table</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop_table_statement ::=  DROP TABLE [ IF EXISTS ] table_name</span><br></pre></td></tr></table></figure><h2 id="æˆªæ–­Tableï¼ˆæ¸…ç©ºè¡¨æ•°æ®ï¼‰"><a href="#æˆªæ–­Tableï¼ˆæ¸…ç©ºè¡¨æ•°æ®ï¼‰" class="headerlink" title="æˆªæ–­Tableï¼ˆæ¸…ç©ºè¡¨æ•°æ®ï¼‰"></a>æˆªæ–­Tableï¼ˆæ¸…ç©ºè¡¨æ•°æ®ï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate_statement ::=  TRUNCATE [ TABLE ] table_name</span><br></pre></td></tr></table></figure><p>ç”±äºè¡¨æ˜¯å”¯ä¸€å¯ä»¥åœ¨å½“å‰æˆªæ–­çš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥çœç•¥TABLEå…³é”®å­—ã€‚</p><p>æˆªæ–­è¡¨ä¼šæ°¸ä¹…åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰ç°æœ‰æ•°æ®ï¼Œä½†ä¸ä¼šåˆ é™¤è¡¨æœ¬èº«ã€‚</p><h1 id="Cassandraæ•°æ®ç»“æ„"><a href="#Cassandraæ•°æ®ç»“æ„" class="headerlink" title="Cassandraæ•°æ®ç»“æ„"></a>Cassandraæ•°æ®ç»“æ„</h1><blockquote><p>CQLæ˜¯ä¸€ç§ç±»å‹åŒ–è¯­è¨€ï¼Œæ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹é›†ï¼ŒåŒ…æ‹¬æœ¬åœ°ç±»å‹ï¼Œé›†åˆç±»å‹ï¼Œç”¨æˆ·å®šä¹‰ç±»å‹ï¼Œå…ƒç»„ç±»å‹å’Œè‡ªå®šä¹‰ç±»å‹ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cql_type ::=  native_type | collection_type | user_defined_type | tuple_type | custom_type</span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°ç±»å‹ï¼ˆNative-Typesï¼‰"><a href="#æœ¬åœ°ç±»å‹ï¼ˆNative-Typesï¼‰" class="headerlink" title="æœ¬åœ°ç±»å‹ï¼ˆNative Typesï¼‰"></a>æœ¬åœ°ç±»å‹ï¼ˆNative Typesï¼‰</h2><table><thead><tr><th>ç±»å‹</th><th>å¸¸é‡æ”¯æŒ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ascii</td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>ASCIIå­—ç¬¦ä¸²</td></tr><tr><td><code>bigint</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>64ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>blob</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-blob"><code>blob</code></a></td><td>ä»»æ„å­—èŠ‚ï¼ˆæ— éªŒè¯ï¼‰</td></tr><tr><td><code>boolean</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-boolean"><code>boolean</code></a></td><td><code>true</code>æˆ–<code>false</code></td></tr><tr><td><code>counter</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>è®¡æ•°å™¨åˆ—ï¼ˆ64ä½æœ‰ç¬¦å·å€¼ï¼‰</td></tr><tr><td><code>date</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a>ï¼Œ <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>æ—¥æœŸï¼ˆæ²¡æœ‰ç›¸åº”çš„æ—¶é—´å€¼ï¼‰</td></tr><tr><td><code>decimal</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a>ï¼Œ <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-float"><code>float</code></a></td><td>åè¿›åˆ¶å¯å˜ç²¾åº¦</td></tr><tr><td><code>double</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a> <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-float"><code>float</code></a></td><td>64ä½IEEE-754æµ®ç‚¹</td></tr><tr><td><code>duration</code></td><td><code>duration</code></td><td>æŒç»­æ—¶é—´ï¼ˆçº³ç§’ç²¾åº¦ï¼‰</td></tr><tr><td><code>float</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a>ï¼Œ <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-float"><code>float</code></a></td><td>32ä½IEEE-754æµ®ç‚¹</td></tr><tr><td><code>inet</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>IPåœ°å€ï¼ŒIPv4ï¼ˆ4å­—èŠ‚é•¿ï¼‰æˆ–IPv6ï¼ˆ16å­—èŠ‚é•¿ï¼‰</td></tr><tr><td><code>int</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>32ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>smallint</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>16ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>text</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>UTF8ç¼–ç çš„å­—ç¬¦ä¸²</td></tr><tr><td><code>time</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a>ï¼Œ <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>å…·æœ‰çº³ç§’ç²¾åº¦çš„æ—¶é—´ï¼ˆæ²¡æœ‰ç›¸åº”çš„æ—¥æœŸå€¼ï¼‰</td></tr><tr><td><code>timestamp</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a>ï¼Œ <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>æ—¶é—´æˆ³ï¼ˆæ—¥æœŸå’Œæ—¶é—´ï¼‰ï¼Œç²¾åº¦ä¸ºæ¯«ç§’</td></tr><tr><td><code>timeuuid</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-uuid"><code>uuid</code></a></td><td><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a>ï¼ˆç‰ˆæœ¬1ï¼‰ï¼Œé€šå¸¸ç”¨ä½œâ€œæ— å†²çªâ€æ—¶é—´æˆ³</td></tr><tr><td><code>tinyint</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>8ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>uuid</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-uuid"><code>uuid</code></a></td><td>ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a>ï¼ˆä»»ä½•ç‰ˆæœ¬ï¼‰</td></tr><tr><td><code>varchar</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-string"><code>string</code></a></td><td>UTF8ç¼–ç çš„å­—ç¬¦ä¸²</td></tr><tr><td><code>varint</code></td><td><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/definitions.html#grammar-token-integer"><code>integer</code></a></td><td>ä»»æ„ç²¾åº¦æ•´æ•°</td></tr></tbody></table><p>å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯æ—¶é—´ç±»å‹ï¼š</p><h3 id="timestamps"><a href="#timestamps" class="headerlink" title="timestamps"></a>timestamps</h3><blockquote><p>æ—¶é—´æˆ³ç±»å‹çš„å€¼è¢«ç¼–ç ä¸º64ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œè¡¨ç¤ºè‡ªæ ‡å‡†åŸºå‡†æ—¶é—´ï¼ˆç§°ä¸ºçºªå…ƒï¼š1970å¹´1æœˆ1æ—¥æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´00:00:00ï¼‰ä»¥æ¥çš„æ¯«ç§’æ•°ã€‚</p></blockquote><ul><li><code>1299038700000</code></li><li><code>&#39;2011-02-03 04:05+0000&#39;</code></li><li><code>&#39;2011-02-03 04:05:00+0000&#39;</code></li><li><code>&#39;2011-02-03 04:05:00.000+0000&#39;</code></li><li><code>&#39;2011-02-03T04:05+0000&#39;</code></li><li><code>&#39;2011-02-03T04:05:00+0000&#39;</code></li><li><code>&#39;2011-02-03T04:05:00.000+0000&#39;</code></li></ul><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM point</span><br><span class="line">WHERE ts = &#x27;2018-11-15 00:00:30.557+0000&#x27;;</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM point</span><br><span class="line">WHERE ts = 1542211230557;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>+0000</code>æ˜¯RFC 822 4-digitæ—¶åŒºè§„èŒƒï¼Œ<code>+0000</code>æŒ‡GMTã€‚ç¾å›½å¤ªå¹³æ´‹æ ‡å‡†æ—¶é—´ä¸º<code>-0800</code>ï¼Œä¸­å›½åŒ—äº¬æ ‡å‡†æ—¶é—´ä¸º<code>+8000</code>ï¼Œå®˜æ–¹å»ºè®®<strong>æ¯æ¬¡æ’å…¥æŸ¥è¯¢éƒ½å¸¦ä¸Šæ—¶åŒº</strong>ï¼Œä¸åŠ çš„è¯ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨CassandraèŠ‚ç‚¹é…ç½®çš„æ—¶åŒºï¼Œå¯èƒ½ä¼šå‡ºç°æ—¶åŒºä¸ä¸€è‡´å¯¼è‡´çš„æŸ¥è¯¢å¤±è´¥é—®é¢˜ã€‚</p><h3 id="dates"><a href="#dates" class="headerlink" title="dates"></a>dates</h3><blockquote><p>æ—¥æœŸç±»å‹çš„å€¼è¢«ç¼–ç ä¸º32ä½æ— ç¬¦å·æ•´æ•°ï¼Œè¡¨ç¤ºåœ¨è¯¥èŒƒå›´çš„ä¸­å¿ƒå¤„å…·æœ‰â€œçºªå…ƒâ€çš„å¤©æ•°ï¼ˆ2^31ï¼‰ã€‚å¤§çºªå…ƒæ˜¯1970å¹´1æœˆ1æ—¥ã€‚</p></blockquote><p>è‡³äºæ—¶é—´æˆ³ï¼Œæ—¥æœŸå¯ä»¥ä½œä¸ºæ•´æ•°æˆ–ä½¿ç”¨æ—¥æœŸå­—ç¬¦ä¸²è¾“å…¥ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ ¼å¼åº”ä¸º<code>yyyy-mm-dd</code>ï¼ˆä¾‹å¦‚â€™2011-02-03â€™ï¼‰ã€‚</p><h3 id="times"><a href="#times" class="headerlink" title="times"></a>times</h3><blockquote><p>æ—¶é—´ç±»å‹çš„å€¼è¢«ç¼–ç ä¸º64ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œè¡¨ç¤ºè‡ªåˆå¤œä»¥æ¥çš„çº³ç§’æ•°ã€‚</p></blockquote><p>å¯¹äºæ—¶é—´æˆ³ï¼Œå¯ä»¥ä»¥æ•´æ•°æˆ–è¡¨ç¤ºæ—¶é—´çš„å­—ç¬¦ä¸²çš„å½¢å¼è¾“å…¥æ—¶é—´ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ ¼å¼åº”ä¸º<code>hh:mm:ss [.fffffffff]</code>ï¼ˆå…¶ä¸­äºšç§’ç²¾åº¦æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæä¾›ï¼Œåˆ™å¯ä»¥å°äºçº³ç§’ï¼‰ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€æ®µæ—¶é—´å†…çš„æœ‰æ•ˆè¾“å…¥ï¼š</p><ul><li><code>&#39;08:12:54&#39;</code></li><li><code>&#39;08:12:54.123&#39;</code></li><li><code>&#39;08:12:54.123456&#39;</code></li><li><code>&#39;08:12:54.123456789&#39;</code></li></ul><h3 id="durations"><a href="#durations" class="headerlink" title="durations"></a>durations</h3><blockquote><p>æŒç»­æ—¶é—´ç±»å‹çš„å€¼è¢«ç¼–ç ä¸º3ä¸ªæœ‰ç¬¦å·æ•´æ•°çš„å¯å˜é•¿åº¦ã€‚è¿™æ˜¯å› ä¸ºä¸€ä¸ªæœˆçš„å¤©æ•°å¯ä»¥æ”¹å˜ï¼Œä¸€å¤©å¯ä»¥æœ‰23æˆ–25å°æ—¶ï¼Œå…·ä½“å–å†³äºå¤ä»¤æ—¶ã€‚</p><ul><li><p>ç¬¬ä¸€ä¸ªæ•´æ•°è¡¨ç¤ºæœˆæ•°ï¼ˆ32ä½æ•´æ•°ï¼‰</p></li><li><p>ç¬¬äºŒä¸ªè¡¨ç¤ºå¤©æ•°ï¼ˆ32ä½æ•´æ•°ï¼‰</p></li><li><p>ç¬¬ä¸‰ä¸ªè¡¨ç¤ºçº³ç§’æ•°ï¼ˆ64ä½æ•´æ•°ï¼‰</p></li></ul></blockquote><ol><li>æ”¯æŒçš„å•ä½ï¼š</li></ol><ul><li><code>y</code>: å¹´(12 æœˆ)</li><li><code>mo</code>: æœˆ (1 æœˆ)</li><li><code>w</code>: å‘¨(7 å¤©)</li><li><code>d</code>: å¤©(1 å¤©)</li><li><code>h</code>: å°æ—¶(3,600,000,000,000 çº³ç§’)</li><li><code>m</code>: åˆ†é’Ÿ(60,000,000,000 çº³)</li><li><code>s</code>: ç§’(1,000,000,000 çº³)</li><li><code>ms</code>: æ¯«ç§’(1,000,000 çº³)</li><li><code>us</code> or <code>Âµs</code> : å¾®å¦™(1000 çº³)</li><li><code>ns</code>: çº³ç§’(1 çº³)</li></ul><ol start="2"><li>ISO 8601æ ¼å¼ï¼š<code>P[n]Y[n]M[n]DT[n]H[n]M[n]S or P[n]W</code></li><li>ISO 8601æ›¿ä»£æ ¼å¼ï¼š<code>P[YYYY]-[MM]-[DD]T[hh]:[mm]:[ss]</code></li></ol><p>æ’å…¥ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO RiderResults (rider, race, result) VALUES (&#x27;Christopher Froome&#x27;, &#x27;Tour de France&#x27;, 89h4m48s);</span><br><span class="line">INSERT INTO RiderResults (rider, race, result) VALUES (&#x27;BARDET Romain&#x27;, &#x27;Tour de France&#x27;, PT89H8M53S);</span><br><span class="line">INSERT INTO RiderResults (rider, race, result) VALUES (&#x27;QUINTANA Nairo&#x27;, &#x27;Tour de France&#x27;, P0000-00-00T89:09:09);</span><br></pre></td></tr></table></figure><blockquote><p>æŒç»­æ—¶é—´åˆ—ä¸èƒ½ä½œä¸ºä¸»é”®ã€‚è¿™æ˜¯ç”±äºæ— æ³•ç²¾ç¡®ç¡®è®¤æŒç»­æ—¶é—´ã€‚å¦‚æœæ²¡æœ‰æ—¥æœŸä¸Šä¸‹æ–‡ï¼Œå®é™…ä¸Šä¸å¯èƒ½çŸ¥é“1ä¸ªæœˆæ˜¯å¦å¤§äº29å¤©ã€‚</p><p>1å¤©çš„æŒç»­æ—¶é—´ä¹Ÿä¸ç­‰äº24hï¼Œå› ä¸ºæŒç»­æ—¶é—´ç±»å‹éœ€è¦æ”¯æŒå¤ä»¤æ—¶ã€‚</p></blockquote><h2 id="é›†åˆç±»å‹ï¼ˆCollectionsï¼‰"><a href="#é›†åˆç±»å‹ï¼ˆCollectionsï¼‰" class="headerlink" title="é›†åˆç±»å‹ï¼ˆCollectionsï¼‰"></a>é›†åˆç±»å‹ï¼ˆCollectionsï¼‰</h2><p>cassandraæ”¯æŒä¸‰ç§ç±»å‹çš„é›†åˆï¼š<a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/types.html#maps">Maps</a>, <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/types.html#sets">Sets</a> and <a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/types.html#lists">Lists</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">collection_type ::=  MAP &#x27;&lt;&#x27; cql_type &#x27;,&#x27; cql_type &#x27;&gt;&#x27;</span><br><span class="line">                     | SET &#x27;&lt;&#x27; cql_type &#x27;&gt;&#x27;</span><br><span class="line">                     | LIST &#x27;&lt;&#x27; cql_type &#x27;&gt;&#x27;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¿™æ ·è¾“å…¥é›†åˆç±»å‹çš„æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">collection_literal ::=  map_literal | set_literal | list_literal</span><br><span class="line">map_literal        ::=  &#x27;&#123;&#x27; [ term &#x27;:&#x27; term (&#x27;,&#x27; term : term)* ] &#x27;&#125;&#x27;</span><br><span class="line">set_literal        ::=  &#x27;&#123;&#x27; [ term (&#x27;,&#x27; term)* ] &#x27;&#125;&#x27;</span><br><span class="line">list_literal       ::=  &#x27;[&#x27; [ term (&#x27;,&#x27; term)* ] &#x27;]&#x27;</span><br></pre></td></tr></table></figure><h3 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h3><blockquote><p>Mapsæ˜¯ä¸€ç»„ï¼ˆæœ‰åºï¼‰é”®å€¼å¯¹ï¼Œå…¶ä¸­é”®æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”æŒ‰å…¶é”®æ’åºã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE users (</span><br><span class="line">    id text PRIMARY KEY,</span><br><span class="line">    name text,</span><br><span class="line">    favs map&lt;text, text&gt; // A map of text keys, and text values</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO users (id, name, favs)</span><br><span class="line">           VALUES (&#x27;jsmith&#x27;, &#x27;John Smith&#x27;, &#123; &#x27;fruit&#x27; : &#x27;Apple&#x27;, &#x27;band&#x27; : &#x27;Beatles&#x27; &#125;);</span><br><span class="line"></span><br><span class="line">// Replace the existing map entirely.</span><br><span class="line">UPDATE users SET favs = &#123; &#x27;fruit&#x27; : &#x27;Banana&#x27; &#125; WHERE id = &#x27;jsmith&#x27;;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼ŒMapsè¿˜å…·æœ‰ä¸€äº›é«˜çº§ç‰¹æ€§ï¼š</p><ul><li>æ›´æ–°æˆ–æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET favs[&#x27;author&#x27;] = &#x27;Ed Poe&#x27; WHERE id = &#x27;jsmith&#x27;;</span><br><span class="line">UPDATE users SET favs = favs + &#123; &#x27;movie&#x27; : &#x27;Cassablanca&#x27;, &#x27;band&#x27; : &#x27;ZZ Top&#x27; &#125; WHERE id = &#x27;jsmith&#x27;;</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼ˆå¦‚æœä¸€ä¸ªå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ é™¤å®ƒæ˜¯ä¸€ä¸ªæ— æ•ˆæ“ä½œä½†ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE favs[&#x27;author&#x27;] FROM users WHERE id = &#x27;jsmith&#x27;;</span><br><span class="line">UPDATE users SET favs = favs - &#123; &#x27;movie&#x27;, &#x27;band&#x27;&#125; WHERE id = &#x27;jsmith&#x27;;</span><br></pre></td></tr></table></figure><h3 id="Sets"><a href="#Sets" class="headerlink" title="Sets"></a>Sets</h3><blockquote><p>Setsæ˜¯å”¯ä¸€å€¼çš„ï¼ˆå·²æ’åºï¼‰é›†åˆã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE users (</span><br><span class="line">    id text PRIMARY KEY,</span><br><span class="line">    name text,</span><br><span class="line">    favs map&lt;text, text&gt; // A map of text keys, and text values</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO users (id, name, favs)</span><br><span class="line">           VALUES (&#x27;jsmith&#x27;, &#x27;John Smith&#x27;, &#123; &#x27;fruit&#x27; : &#x27;Apple&#x27;, &#x27;band&#x27; : &#x27;Beatles&#x27; &#125;);</span><br><span class="line"></span><br><span class="line">// Replace the existing map entirely.</span><br><span class="line">UPDATE users SET favs = &#123; &#x27;fruit&#x27; : &#x27;Banana&#x27; &#125; WHERE id = &#x27;jsmith&#x27;;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼ŒSetsä¹Ÿå…·æœ‰ä¸€äº›é«˜çº§ç‰¹æ€§ï¼š</p><ul><li>æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼ˆå› ä¸ºè¿™æ˜¯ä¸€ä¸ªé›†åˆï¼Œæ’å…¥ä¸€ä¸ªå·²å­˜åœ¨çš„å…ƒç´ æ˜¯ä¸€ä¸ªæ— æ•ˆæ“ä½œï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE images SET tags = tags + &#123; &#x27;gray&#x27;, &#x27;cuddly&#x27; &#125; WHERE name = &#x27;cat.jpg&#x27;;</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼ˆå¦‚æœä¸€ä¸ªå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ é™¤å®ƒæ˜¯ä¸€ä¸ªæ— æ•ˆæ“ä½œä½†ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE images SET tags = tags - &#123; &#x27;cat&#x27; &#125; WHERE name = &#x27;cat.jpg&#x27;;</span><br></pre></td></tr></table></figure><h3 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h3><blockquote><p>Listsæ˜¯éå”¯ä¸€å€¼çš„ï¼ˆå·²æ’åºï¼‰é›†åˆï¼Œå…¶ä¸­å…ƒç´ æŒ‰åˆ—è¡¨ä¸­çš„ä½ç½®æ’åºã€‚å®ƒä¸Setsçš„åŒºåˆ«å°±åœ¨äºæ˜¯å¦æ˜¯å”¯ä¸€å€¼ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE plays (</span><br><span class="line">    id text PRIMARY KEY,</span><br><span class="line">    game text,</span><br><span class="line">    players int,</span><br><span class="line">    scores list&lt;int&gt; // A list of integers</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">INSERT INTO plays (id, game, players, scores)</span><br><span class="line">           VALUES (&#x27;123-afde&#x27;, &#x27;quake&#x27;, 3, [17, 4, 2]);</span><br><span class="line"></span><br><span class="line">// Replace the existing list entirely</span><br><span class="line">UPDATE plays SET scores = [ 3, 9, 4] WHERE id = &#x27;123-afde&#x27;;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼ŒListsåŒæ ·ä¹Ÿå…·æœ‰ä¸€äº›é«˜çº§ç‰¹æ€§ï¼š</p><ul><li>åœ¨åˆ—è¡¨å¤´æˆ–å°¾æ·»åŠ å…ƒç´ </li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE plays SET players = 5, scores = scores + [ 14, 21 ] WHERE id = &#x27;123-afde&#x27;;</span><br><span class="line">UPDATE plays SET players = 6, scores = [ 3 ] + scores WHERE id = &#x27;123-afde&#x27;;</span><br></pre></td></tr></table></figure><p>ğŸ’¡è¯¥æ“ä½œä¸æ˜¯å¹‚ç­‰çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨å…¶ä¸­ä¸€ä¸ªæ“ä½œè¶…æ—¶æ—¶ï¼Œé‡è¯•æ“ä½œæ˜¯ä¸å®‰å…¨çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒä¸€æ•°æ®æ’å…¥ä¸¤æ¬¡ã€‚</p><ul><li>åœ¨åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡å¤„è®¾ç½®å€¼ã€‚è¯¥åˆ—è¡¨å¿…é¡»é•¿åº¦å¤§äºæ­¤ä¸‹æ ‡ï¼Œå¦åˆ™å°†æŠ›å‡ºåˆ—è¡¨å¤ªå°çš„é”™è¯¯</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE plays SET scores[1] = 7 WHERE id = &#x27;123-afde&#x27;;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡åˆ—è¡¨æŒ‡å®šä¸‹æ ‡åˆ é™¤å…ƒç´ ã€‚è¯¥åˆ—è¡¨å¿…é¡»é•¿åº¦å¤§äºæ­¤ä¸‹æ ‡ï¼Œå¦åˆ™å°†æŠ›å‡ºåˆ—è¡¨å¤ªå°çš„é”™è¯¯ã€‚æ­¤å¤–ï¼Œå½“æ“ä½œä»åˆ—è¡¨ä¸­åˆ é™¤å…ƒç´ æ—¶ï¼Œåˆ—è¡¨å¤§å°å°†å‡1ï¼Œä»è€Œæ”¹å˜æ­¤ä¸‹æ ‡ä¹‹åæ‰€æœ‰å…ƒç´ çš„ä½ç½®</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE scores[1] FROM plays WHERE id = &#x27;123-afde&#x27;;</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡ä¹‹é—´çš„æ‰€æœ‰å…ƒç´ </li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE plays SET scores = scores - [ 12, 21 ] WHERE id = &#x27;123-afde&#x27;;</span><br></pre></td></tr></table></figure><p>ğŸ’¡ä»¥ä¸Š2,3,4æ“ä½œä¼šå‡ºç°å†…éƒ¨çš„ <code>read-before-write</code>ï¼Œä¼šæ¯”é€šå¸¸çš„æ›´æ–°æ¶ˆè€—æ›´å¤šçš„èµ„æºï¼Œæ‰€ä»¥å°½é‡ä½¿ç”¨<a href="#Sets">Sets</a>ä»£æ›¿Listsã€‚</p><h2 id="ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUser-Defined-Typesï¼‰"><a href="#ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUser-Defined-Typesï¼‰" class="headerlink" title="ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUser-Defined Typesï¼‰"></a>ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUser-Defined Typesï¼‰</h2><blockquote><p>CQLæ”¯æŒç”¨æˆ·å®šä¹‰ç±»å‹ï¼ˆä»¥ä¸‹ç®€ç§°UDTï¼‰ã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢<code>create_type_statement</code>ï¼Œ<code>alter_type_statement</code>å’Œ<code>drop_type_statement</code>åˆ›å»ºï¼Œä¿®æ”¹å’Œåˆ é™¤æ­¤ç±»å‹ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user_defined_type ::=  udt_name</span><br><span class="line">udt_name          ::=  [ keyspace_name &#x27;.&#x27; ] identifier</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create_type_statement ::=  CREATE TYPE [ IF NOT EXISTS ] udt_name</span><br><span class="line">                               &#x27;(&#x27; field_definition ( &#x27;,&#x27; field_definition )* &#x27;)&#x27;</span><br><span class="line">field_definition      ::=  identifier cql_type</span><br></pre></td></tr></table></figure><p>UDTæœ‰ä¸€ä¸ªåç§°ï¼ˆç”¨äºå£°æ˜è¯¥ç±»å‹çš„åˆ—ï¼‰ï¼Œæ˜¯ä¸€ç»„å‘½åå’Œç±»å‹å­—æ®µã€‚å­—æ®µåç§°å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬é›†åˆæˆ–å…¶ä»–UDTã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE TYPE phone (</span><br><span class="line">    country_code int,</span><br><span class="line">    number text,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">CREATE TYPE address (</span><br><span class="line">    street text,</span><br><span class="line">    city text,</span><br><span class="line">    zip text,</span><br><span class="line">    phones map&lt;text, phone&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">CREATE TABLE user (</span><br><span class="line">    name text PRIMARY KEY,</span><br><span class="line">    addresses map&lt;text, frozen&lt;address&gt;&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ğŸ’¡æ³¨æ„</p><ul><li>å°è¯•åˆ›å»ºç°æœ‰ç±»å‹æ—¶è¯·ä½¿ç”¨<code>IF NOT EXISTS</code>é€‰é¡¹ï¼Œå¦åˆ™å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚</li><li>UDTæœ¬è´¨ä¸Šç»‘å®šåˆ°åˆ›å»ºå®ƒçš„é”®ç©ºé—´ï¼Œå¹¶ä¸”åªèƒ½åœ¨è¯¥é”®ç©ºé—´ä¸­ä½¿ç”¨ã€‚åœ¨åˆ›å»ºæ—¶ï¼Œå¦‚æœç±»å‹åç§°ä»¥é”®ç©ºé—´åç§°ä¸ºå‰ç¼€ï¼Œåˆ™åœ¨è¯¥é”®ç©ºé—´ä¸­åˆ›å»ºå®ƒã€‚å¦åˆ™ï¼Œå®ƒå°†åœ¨å½“å‰é”®ç©ºé—´ä¸­åˆ›å»ºã€‚</li><li>ä»Cassandra 4.0å¼€å§‹ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¿…é¡»å†»ç»“UDTï¼Œå› æ­¤åœ¨ä¸Šé¢çš„è¡¨å®šä¹‰ä¸­å†»ç»“äº†<code>&lt;address&gt;</code>ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://docs.datastax.com/en/archived/cql/3.1/cql/cql_reference/collection_type_r.html">å†»ç»“</a>éƒ¨åˆ†ã€‚</li></ul><h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter_type_statement    ::=  ALTER TYPE udt_name alter_type_modification</span><br><span class="line">alter_type_modification ::=  ADD field_definition</span><br><span class="line">                             | RENAME identifier TO identifier ( identifier TO identifier )*</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸ªUDTï¼Œå¯ä»¥ï¼š</p><ol><li>åœ¨ç±»å‹ä¸­æ·»åŠ ä¸€ä¸ªæ–°å­—æ®µ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TYPE address ADD country text</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼šæ–°æ·»åŠ çš„å­—æ®µåœ¨ä¹‹å‰çš„è®°å½•ä¸­ï¼Œéƒ½å°†è¢«ç½®ä¸ºNULLã€‚</p><ol start="2"><li>é‡å‘½åè¯¥ç±»å‹çš„å­—æ®µ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TYPE address RENAME zip TO zipcode</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop_type_statement ::=  DROP TYPE [ IF EXISTS ] udt_name</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udt_literal ::=  &#x27;&#123;&#x27; identifier &#x27;:&#x27; term ( &#x27;,&#x27; identifier &#x27;:&#x27; term )* &#x27;&#125;&#x27;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨UDTæœ‰ç‚¹åƒ<a href="#Maps">Maps</a>ï¼Œä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO user (name, addresses)</span><br><span class="line">          VALUES (&#x27;z3 Pr3z1den7&#x27;, &#123;</span><br><span class="line">              &#x27;home&#x27; : &#123;</span><br><span class="line">                  street: &#x27;1600 Pennsylvania Ave NW&#x27;,</span><br><span class="line">                  city: &#x27;Washington&#x27;,</span><br><span class="line">                  zip: &#x27;20500&#x27;,</span><br><span class="line">                  phones: &#123; &#x27;cell&#x27; : &#123; country_code: 1, number: &#x27;202 456-1111&#x27; &#125;,</span><br><span class="line">                            &#x27;landline&#x27; : &#123; country_code: 1, number: &#x27;...&#x27; &#125; &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              &#x27;work&#x27; : &#123;</span><br><span class="line">                  street: &#x27;1600 Pennsylvania Ave NW&#x27;,</span><br><span class="line">                  city: &#x27;Washington&#x27;,</span><br><span class="line">                  zip: &#x27;20500&#x27;,</span><br><span class="line">                  phones: &#123; &#x27;fax&#x27; : &#123; country_code: 1, number: &#x27;...&#x27; &#125; &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)</span><br></pre></td></tr></table></figure><h2 id="å…ƒç»„ï¼ˆTuplesï¼‰"><a href="#å…ƒç»„ï¼ˆTuplesï¼‰" class="headerlink" title="å…ƒç»„ï¼ˆTuplesï¼‰"></a>å…ƒç»„ï¼ˆTuplesï¼‰</h2><blockquote><p>CQLè¿˜æ”¯æŒå…ƒç»„å’Œå…ƒç»„ç±»å‹ï¼ˆå…ƒç´ å¯ä»¥æ˜¯ä¸åŒç±»å‹ï¼‰ï¼Œç±»ä¼¼äºåŒ¿åçš„UDTæˆ–è€…æ˜¯Scalaçš„Tupleç±»å‹ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tuple_type    ::=  TUPLE &#x27;&lt;&#x27; cql_type ( &#x27;,&#x27; cql_type )* &#x27;&gt;&#x27;</span><br><span class="line">tuple_literal ::=  &#x27;(&#x27; term ( &#x27;,&#x27; term )* &#x27;)&#x27;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE durations (</span><br><span class="line">    event text,</span><br><span class="line">    duration tuple&lt;int, text&gt;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">INSERT INTO durations (event, duration) VALUES (&#x27;ev1&#x27;, (3, &#x27;hours&#x27;));</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰ç±»å‹ï¼ˆCustom-Typesï¼‰"><a href="#è‡ªå®šä¹‰ç±»å‹ï¼ˆCustom-Typesï¼‰" class="headerlink" title="è‡ªå®šä¹‰ç±»å‹ï¼ˆCustom Typesï¼‰"></a>è‡ªå®šä¹‰ç±»å‹ï¼ˆCustom Typesï¼‰</h2><blockquote><p>è‡ªå®šä¹‰ç±»å‹ä¸»è¦æ˜¯ä¸ºäº†<strong>å…¼å®¹è€é¡¹ç›®ï¼Œä¸å»ºè®®ä½¿ç”¨</strong>ã€‚ä½¿ç”¨å·²æœ‰çš„ç±»å‹åŠ ä¸Šç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUDTï¼‰å°±å¤Ÿäº†ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">custom_type ::=  string</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰"><a href="#æ•°æ®å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰" class="headerlink" title="æ•°æ®å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰"></a>æ•°æ®å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰</h1><h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">select_statement ::=  SELECT [ JSON | DISTINCT ] ( select_clause | &#x27;*&#x27; )</span><br><span class="line">                      FROM table_name</span><br><span class="line">                      [ WHERE where_clause ]</span><br><span class="line">                      [ GROUP BY group_by_clause ]</span><br><span class="line">                      [ ORDER BY ordering_clause ]</span><br><span class="line">                      [ PER PARTITION LIMIT (integer | bind_marker) ]</span><br><span class="line">                      [ LIMIT (integer | bind_marker) ]</span><br><span class="line">                      [ ALLOW FILTERING ]</span><br><span class="line">select_clause    ::=  selector [ AS identifier ] ( &#x27;,&#x27; selector [ AS identifier ] )</span><br><span class="line">selector         ::=  column_name</span><br><span class="line">                      | term</span><br><span class="line">                      | CAST &#x27;(&#x27; selector AS cql_type &#x27;)&#x27;</span><br><span class="line">                      | function_name &#x27;(&#x27; [ selector ( &#x27;,&#x27; selector )* ] &#x27;)&#x27;</span><br><span class="line">                      | COUNT &#x27;(&#x27; &#x27;*&#x27; &#x27;)&#x27;</span><br><span class="line">where_clause     ::=  relation ( AND relation )*</span><br><span class="line">relation         ::=  column_name operator term</span><br><span class="line">                      &#x27;(&#x27; column_name ( &#x27;,&#x27; column_name )* &#x27;)&#x27; operator tuple_literal</span><br><span class="line">                      TOKEN &#x27;(&#x27; column_name ( &#x27;,&#x27; column_name )* &#x27;)&#x27; operator term</span><br><span class="line">operator         ::=  &#x27;=&#x27; | &#x27;&lt;&#x27; | &#x27;&gt;&#x27; | &#x27;&lt;=&#x27; | &#x27;&gt;=&#x27; | &#x27;!=&#x27; | IN | CONTAINS | CONTAINS KEY</span><br><span class="line">group_by_clause  ::=  column_name ( &#x27;,&#x27; column_name )*</span><br><span class="line">ordering_clause  ::=  column_name [ ASC | DESC ] ( &#x27;,&#x27; column_name [ ASC | DESC ] )*</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT name, occupation FROM users WHERE userid IN (199, 200, 207);</span><br><span class="line">SELECT JSON name, occupation FROM users WHERE userid = 199;</span><br><span class="line">SELECT name AS user_name, occupation AS user_occupation FROM users;</span><br><span class="line"></span><br><span class="line">SELECT time, value</span><br><span class="line">FROM events</span><br><span class="line">WHERE event_type = &#x27;myEvent&#x27;</span><br><span class="line">  AND time &gt; &#x27;2011-02-03&#x27;</span><br><span class="line">  AND time &lt;= &#x27;2012-01-01&#x27;</span><br><span class="line"></span><br><span class="line">SELECT COUNT (*) AS user_count FROM users;</span><br></pre></td></tr></table></figure><h3 id="Allowing-filtering"><a href="#Allowing-filtering" class="headerlink" title="Allowing filtering"></a>Allowing filtering</h3><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCQLä»…å…è®¸ä¸æ¶‰åŠâ€œè¿‡æ»¤â€æœåŠ¡å™¨ç«¯çš„é€‰æ‹©æŸ¥è¯¢ï¼ŒåŸå› æ˜¯é‚£äº›â€œéè¿‡æ»¤â€æŸ¥è¯¢å…·æœ‰å¯é¢„æµ‹çš„æ€§èƒ½ï¼Œå› ä¸ºå®ƒä»¬çš„æŸ¥è¯¢æ€§èƒ½ä¸Limitæˆæ¯”ä¾‹ã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE users (</span><br><span class="line">    username text PRIMARY KEY,</span><br><span class="line">    firstname text,</span><br><span class="line">    lastname text,</span><br><span class="line">    birth_year int,</span><br><span class="line">    country text</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">CREATE INDEX ON users(birth_year);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ä¸¤ç§æŸ¥è¯¢æ˜¯ä¸éœ€è¦æ·»åŠ <code>ALLOW FILTERING</code>çš„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users;</span><br><span class="line">SELECT * FROM users WHERE birth_year = 1981;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼ŒCassandraéƒ½ä¿è¯è¿™äº›æŸ¥è¯¢æ€§èƒ½ä¸è¿”å›çš„æ•°æ®é‡æˆæ­£æ¯”ã€‚</p><p>è€Œä¸‹é¢çš„è¿™ä¸ªæŸ¥è¯¢ï¼Œåˆ™éœ€è¦å¼ºåˆ¶æ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE birth_year = 1981 AND country = &#x27;FR&#x27; ALLOW FILTERING;</span><br></pre></td></tr></table></figure><p>ğŸ‘‰ğŸ¼ å…³äºå¦‚ä½•å®šä¹‰å¯é¢„æµ‹çš„åˆ—ï¼Œå¯å‚è€ƒ<a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/cql/indexes.html">Cassandraä¸­çš„ç´¢å¼•</a></p><h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">insert_statement ::=  INSERT INTO table_name ( names_values | json_clause )</span><br><span class="line">                      [ IF NOT EXISTS ]</span><br><span class="line">                      [ USING update_parameter ( AND update_parameter )* ]</span><br><span class="line">names_values     ::=  names VALUES tuple_literal</span><br><span class="line">json_clause      ::=  JSON string [ DEFAULT ( NULL | UNSET ) ]</span><br><span class="line">names            ::=  &#x27;(&#x27; column_name ( &#x27;,&#x27; column_name )* &#x27;)&#x27;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO NerdMovies (movie, director, main_actor, year)</span><br><span class="line">                VALUES (&#x27;Serenity&#x27;, &#x27;Joss Whedon&#x27;, &#x27;Nathan Fillion&#x27;, 2005)</span><br><span class="line">      USING TTL 86400;</span><br><span class="line"></span><br><span class="line">INSERT INTO NerdMovies JSON &#x27;&#123;&quot;movie&quot;: &quot;Serenity&quot;,</span><br><span class="line">                              &quot;director&quot;: &quot;Joss Whedon&quot;,</span><br><span class="line">                              &quot;year&quot;: 2005&#125;&#x27;;</span><br></pre></td></tr></table></figure><p>ğŸ’¡è¯·æ³¨æ„</p><ol><li><p>ä¸SQLä¸åŒï¼ŒINSERTé»˜è®¤æƒ…å†µä¸‹ä¸æ£€æŸ¥è¡Œçš„å…ˆå‰å­˜åœ¨ï¼šå¦‚æœä¹‹å‰ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¡Œï¼Œå¦åˆ™æ›´æ–°ã€‚æ­¤å¤–ï¼Œæ²¡æœ‰åŠæ³•çŸ¥é“å‘ç”Ÿäº†å“ªäº›åˆ›å»ºæˆ–æ›´æ–°ã€‚</p></li><li><p>å¦‚æœè¦åšåˆ°å­˜åœ¨åˆ™ä¸æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨<code>IF NOT EXISTS</code>æ¡ä»¶ã€‚ä½†è¯·æ³¨æ„ï¼Œä½¿ç”¨<code>IF NOT EXISTS</code>å°†å¯¼è‡´ä¸å¯å¿½ç•¥çš„æ€§èƒ½æˆæœ¬ï¼ˆå†…éƒ¨ä½¿ç”¨Paxosï¼‰ï¼Œå› æ­¤åº”è°¨æ…ä½¿ç”¨ã€‚</p></li><li><p>INSERTçš„æ‰€æœ‰æ›´æ–°éƒ½ä»¥åŸå­æ–¹å¼å•ç‹¬åº”ç”¨ã€‚</p></li></ol><h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">update_statement ::=  UPDATE table_name</span><br><span class="line">                      [ USING update_parameter ( AND update_parameter )* ]</span><br><span class="line">                      SET assignment ( &#x27;,&#x27; assignment )*</span><br><span class="line">                      WHERE where_clause</span><br><span class="line">                      [ IF ( EXISTS | condition ( AND condition )*) ]</span><br><span class="line">update_parameter ::=  ( TIMESTAMP | TTL ) ( integer | bind_marker )</span><br><span class="line">assignment       ::=  simple_selection &#x27;=&#x27; term</span><br><span class="line">                     | column_name &#x27;=&#x27; column_name ( &#x27;+&#x27; | &#x27;-&#x27; ) term</span><br><span class="line">                     | column_name &#x27;=&#x27; list_literal &#x27;+&#x27; column_name</span><br><span class="line">simple_selection ::=  column_name</span><br><span class="line">                     | column_name &#x27;[&#x27; term &#x27;]&#x27;</span><br><span class="line">                     | column_name &#x27;.&#x27; `field_name</span><br><span class="line">condition        ::=  simple_selection operator term</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">UPDATE NerdMovies USING TTL 400</span><br><span class="line">   SET director   = &#x27;Joss Whedon&#x27;,</span><br><span class="line">       main_actor = &#x27;Nathan Fillion&#x27;,</span><br><span class="line">       year       = 2005</span><br><span class="line"> WHERE movie = &#x27;Serenity&#x27;;</span><br><span class="line"></span><br><span class="line">UPDATE UserActions</span><br><span class="line">   SET total = total + 2</span><br><span class="line">   WHERE user = B70DE1D0-9908-4AE3-BE34-5573E5B09F14</span><br><span class="line">     AND action = &#x27;click&#x27;;</span><br></pre></td></tr></table></figure><p>ğŸ’¡è¯·æ³¨æ„</p><ol><li><p>ä¸SQLä¸åŒï¼ŒUPDATEé»˜è®¤æƒ…å†µä¸‹ä¸æ£€æŸ¥è¡Œçš„å…ˆå‰å­˜åœ¨ï¼ˆé™¤éé€šè¿‡IFï¼‰ï¼šå¦‚æœä¹‹å‰ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¡Œï¼Œå¦åˆ™æ›´æ–°ã€‚æ­¤å¤–ï¼Œæ²¡æœ‰åŠæ³•çŸ¥é“æ˜¯å¦å‘ç”Ÿäº†åˆ›å»ºæˆ–æ›´æ–°ã€‚</p></li><li><p>å¯ä»¥é€šè¿‡IFåœ¨æŸäº›åˆ—ä¸Šä½¿ç”¨æ¡ä»¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé™¤éæ»¡è¶³æ¡ä»¶ï¼Œå¦åˆ™ä¸ä¼šæ›´æ–°è¡Œã€‚ä½†è¯·æ³¨æ„ï¼Œä½¿ç”¨IFæ¡ä»¶ä¼šäº§ç”Ÿä¸å¯å¿½è§†çš„æ€§èƒ½æˆæœ¬ï¼ˆå†…éƒ¨ä½¿ç”¨Paxosï¼‰ï¼Œå› æ­¤åº”è°¨æ…ä½¿ç”¨ã€‚</p></li><li><p>åœ¨UPDATEè¯­å¥ä¸­ï¼ŒåŒä¸€åˆ†åŒºé”®ä¸­çš„æ‰€æœ‰æ›´æ–°éƒ½ä»¥åŸå­æ–¹å¼å•ç‹¬åº”ç”¨ã€‚</p></li></ol><p>æ­¤å¤–ï¼ŒUPDATEæ“ä½œé’ˆå¯¹æŸäº›æ•°æ®ç±»å‹æœ‰å¼ºåˆ¶æ€§è¦æ±‚ï¼š</p><ol><li><code>c = c + 3</code></li></ol><p>ç”¨äºé€’å¢/é€’å‡è®¡æ•°å™¨ã€‚</p><p>â€˜=â€™ç¬¦å·åé¢çš„åˆ—åç§°å¿…é¡»ä¸â€™=â€™ç¬¦å·å‰é¢çš„åˆ—åç›¸åŒã€‚è¯·æ³¨æ„ï¼Œ<strong>ä»…åœ¨è®¡æ•°å™¨ä¸Šå…è®¸é€’å¢/é€’å‡ï¼Œå¹¶ä¸”æ˜¯è®¡æ•°å™¨ä¸Šå…è®¸çš„å”¯ä¸€æ›´æ–°æ“ä½œ</strong>ã€‚</p><ol start="2"><li><code>id = id + &lt;some-collection&gt;</code> å’Œ<code>id[value1] = value2</code></li></ol><p>ç”¨äºé›†åˆã€‚</p><ol start="3"><li><code>id.field = 3</code></li></ol><p>åœ¨éå†»ç»“çš„ç”¨æˆ·å®šä¹‰ç±»å‹ä¸Šè®¾ç½®å­—æ®µçš„å€¼ã€‚</p><h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delete_statement ::=  DELETE [ simple_selection ( &#x27;,&#x27; simple_selection ) ]</span><br><span class="line">                      FROM table_name</span><br><span class="line">                      [ USING update_parameter ( AND update_parameter )* ]</span><br><span class="line">                      WHERE where_clause</span><br><span class="line">                      [ IF ( EXISTS | condition ( AND condition )*) ]</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM NerdMovies USING TIMESTAMP 1240003134</span><br><span class="line"> WHERE movie = &#x27;Serenity&#x27;;</span><br><span class="line"></span><br><span class="line">DELETE phone FROM Users</span><br><span class="line"> WHERE userid IN (C73DE1D3-AF08-40F3-B124-3FF3E5109F22, B70DE1D0-9908-4AE3-BE34-5573E5B09F14);</span><br></pre></td></tr></table></figure><p>ğŸ’¡è¯·æ³¨æ„</p><ol><li><p>WHEREå­å¥æŒ‡å®šè¦åˆ é™¤çš„è¡Œã€‚ä½¿ç”¨INè¿ç®—ç¬¦å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¯­å¥åˆ é™¤å¤šè¡Œã€‚å¯ä»¥ä½¿ç”¨ä¸ç­‰è¿ç®—ç¬¦ï¼ˆä¾‹å¦‚&gt;=ï¼‰åˆ é™¤ä¸€ç³»åˆ—è¡Œã€‚</p></li><li><p>åœ¨DELETEè¯­å¥ä¸­ï¼ŒåŒä¸€åˆ†åŒºé”®ä¸­çš„æ‰€æœ‰åˆ é™¤éƒ½ä»¥åŸå­æ–¹å¼å•ç‹¬åº”ç”¨ã€‚</p></li><li><p>DELETEæ“ä½œå¯ä»¥é€šè¿‡ä½¿ç”¨IFå­å¥æ¥æ¡ä»¶åŒ–ï¼Œç±»ä¼¼äºUPDATEå’ŒINSERTè¯­å¥ã€‚ä½†æ˜¯ï¼Œä¸INSERTå’ŒUPDATEè¯­å¥ä¸€æ ·ï¼Œè¿™å°†å¯¼è‡´ä¸å¯å¿½ç•¥çš„æ€§èƒ½æˆæœ¬ï¼ˆå†…éƒ¨ï¼Œå°†ä½¿ç”¨Paxosï¼‰ï¼Œå› æ­¤åº”è°¨æ…ä½¿ç”¨ã€‚</p></li></ol><h2 id="æ‰¹å¤„ç†"><a href="#æ‰¹å¤„ç†" class="headerlink" title="æ‰¹å¤„ç†"></a>æ‰¹å¤„ç†</h2><blockquote><p>æ‰¹å¤„ç†åªå…è®¸åŒ…å«UPDATEï¼ŒINSERTå’ŒDELETEè¯­å¥ã€‚</p><p>æ‰¹å¤„ç†èŠ‚çœå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œèµ„æºæ¶ˆè€—ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">batch_statement        ::=  BEGIN [ UNLOGGED | COUNTER ] BATCH</span><br><span class="line">                            [ USING update_parameter ( AND update_parameter )* ]</span><br><span class="line">                            modification_statement ( &#x27;;&#x27; modification_statement )*</span><br><span class="line">                            APPLY BATCH</span><br><span class="line">modification_statement ::=  insert_statement | update_statement | delete_statement</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN BATCH</span><br><span class="line">   INSERT INTO users (userid, password, name) VALUES (&#x27;user2&#x27;, &#x27;ch@ngem3b&#x27;, &#x27;second user&#x27;);</span><br><span class="line">   UPDATE users SET password = &#x27;ps22dhds&#x27; WHERE userid = &#x27;user3&#x27;;</span><br><span class="line">   INSERT INTO users (userid, password) VALUES (&#x27;user4&#x27;, &#x27;ch@ngem3c&#x27;);</span><br><span class="line">   DELETE name FROM users WHERE userid = &#x27;user1&#x27;;</span><br><span class="line">APPLY BATCH;</span><br></pre></td></tr></table></figure><p>ğŸ’¡è¯·æ³¨æ„</p><ol><li>å±äºç»™å®šåˆ†åŒºé”®çš„BATCHä¸­çš„æ‰€æœ‰æ›´æ–°éƒ½æ˜¯å•ç‹¬æ‰§è¡Œçš„ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰¹å¤„ç†ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æŒ‰è®°å½•æ‰§è¡Œï¼Œä»¥ç¡®ä¿æ‰€æœ‰å˜æ›´éƒ½æœ€ç»ˆå®Œæˆï¼ˆæˆ–ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼‰ã€‚ç±»ä¼¼äºSQLäº‹åŠ¡ï¼Œä½†ä¸å®Œå…¨ç­‰åŒäºSQLäº‹åŠ¡ã€‚</li></ol><h3 id="UNLOGGED-batches"><a href="#UNLOGGED-batches" class="headerlink" title="UNLOGGED batches"></a>UNLOGGED batches</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCassandraä½¿ç”¨æ‰¹å¤„ç†æ—¥å¿—æ¥ç¡®ä¿æ‰€æœ‰å˜æ›´éƒ½æœ€ç»ˆå®Œæˆï¼ˆæˆ–ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼‰ã€è¯·æ³¨æ„ï¼Œæ“ä½œä»…åœ¨å•ä¸ªåˆ†åŒºä¸­éš”ç¦»ã€‘ã€‚</p><p>æ‰¹å¤„ç†è·¨è¶Šå¤šä¸ªåˆ†åŒºæ—¶ï¼Œæ‰¹å¤„ç†åœ¨æ€§èƒ½ä¸Šä¼šæœ‰æ‰€æŸå¤±ã€‚å¯ä»¥ä½¿ç”¨UNLOGGEDé€‰é¡¹æ¥è·³è¿‡æ‰¹å¤„ç†æ—¥å¿—ï¼Œä¸è¿‡ï¼Œå¦‚æœæ‰¹å¤„ç†å¤±è´¥ï¼Œå¯èƒ½ä¼šé€ æˆæ‰¹å¤„ç†ä¸­çš„ä»»åŠ¡éƒ¨åˆ†æˆåŠŸéƒ¨åˆ†å¤±è´¥ï¼Œè¯·è°¨æ…é€‰æ‹©ã€‚</p><h3 id="COUNTER-batches"><a href="#COUNTER-batches" class="headerlink" title="COUNTER batches"></a>COUNTER batches</h3><p>ä½¿ç”¨COUNTERé€‰é¡¹è¿›è¡Œæ‰¹é‡è®¡æ•°å™¨æ›´æ–°ã€‚</p><p>ä¸Cassandraä¸­çš„å…¶ä»–æ›´æ–°ä¸åŒï¼Œè®¡æ•°å™¨æ›´æ–°ä¸æ˜¯å¹‚ç­‰çš„ã€‚</p><h1 id="å‚è€ƒèµ„æº"><a href="#å‚è€ƒèµ„æº" class="headerlink" title="å‚è€ƒèµ„æº"></a>å‚è€ƒèµ„æº</h1><p><a target="_blank" rel="noopener" href="http://cassandra.apache.org/doc/latest/">Apache Cassandra Documentation</a></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="https://blog.gcdd.top">gcdd1993</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://blog.gcdd.top/p/60138/">https://blog.gcdd.top/p/60138/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://blog.gcdd.top" target="_blank">è§‚æ²§æµ·</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cassandra/">Cassandra</a></div><div class="post_share"><div class="social-share" data-image="/asserts/images/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/12805/" title="Ubuntuåˆ‡æ¢ä¸ºé˜¿é‡Œé•œåƒæº"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Ubuntuåˆ‡æ¢ä¸ºé˜¿é‡Œé•œåƒæº</div></div></a></div><div class="next-post pull-right"><a href="/p/7877/" title="è®°ä¸€æ¬¡Postgres CPUçˆ†æ»¡æ•…éšœ"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">è®°ä¸€æ¬¡Postgres CPUçˆ†æ»¡æ•…éšœ</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">å‡†å¤‡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Keyspace"><span class="toc-number">2.</span> <span class="toc-text">Keyspace</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAKeyspace"><span class="toc-number">2.1.</span> <span class="toc-text">åˆ›å»ºKeyspace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Keyspace"><span class="toc-number">2.2.</span> <span class="toc-text">ä½¿ç”¨Keyspace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9Keyspace%EF%BC%88replication-factor%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">ä¿®æ”¹Keyspaceï¼ˆreplication factorï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8BKeyspace"><span class="toc-number">2.4.</span> <span class="toc-text">æŸ¥çœ‹Keyspace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4Keyspace"><span class="toc-number">2.5.</span> <span class="toc-text">åˆ é™¤Keyspace</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Table"><span class="toc-number">3.</span> <span class="toc-text">Table</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BATable"><span class="toc-number">3.1.</span> <span class="toc-text">åˆ›å»ºTable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%88%97"><span class="toc-number">3.1.1.</span> <span class="toc-text">é™æ€åˆ—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9Table"><span class="toc-number">3.2.</span> <span class="toc-text">ä¿®æ”¹Table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4Table"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ é™¤Table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%AA%E6%96%ADTable%EF%BC%88%E6%B8%85%E7%A9%BA%E8%A1%A8%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">æˆªæ–­Tableï¼ˆæ¸…ç©ºè¡¨æ•°æ®ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cassandra%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">4.</span> <span class="toc-text">Cassandraæ•°æ®ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E7%B1%BB%E5%9E%8B%EF%BC%88Native-Types%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">æœ¬åœ°ç±»å‹ï¼ˆNative Typesï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#timestamps"><span class="toc-number">4.1.1.</span> <span class="toc-text">timestamps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dates"><span class="toc-number">4.1.2.</span> <span class="toc-text">dates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#times"><span class="toc-number">4.1.3.</span> <span class="toc-text">times</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#durations"><span class="toc-number">4.1.4.</span> <span class="toc-text">durations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%EF%BC%88Collections%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">é›†åˆç±»å‹ï¼ˆCollectionsï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Maps"><span class="toc-number">4.2.1.</span> <span class="toc-text">Maps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sets"><span class="toc-number">4.2.2.</span> <span class="toc-text">Sets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lists"><span class="toc-number">4.2.3.</span> <span class="toc-text">Lists</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%EF%BC%88User-Defined-Types%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUser-Defined Typesï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA"><span class="toc-number">4.3.1.</span> <span class="toc-text">åˆ›å»º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9"><span class="toc-number">4.3.2.</span> <span class="toc-text">ä¿®æ”¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">4.3.3.</span> <span class="toc-text">åˆ é™¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">4.3.4.</span> <span class="toc-text">ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%83%E7%BB%84%EF%BC%88Tuples%EF%BC%89"><span class="toc-number">4.4.</span> <span class="toc-text">å…ƒç»„ï¼ˆTuplesï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%EF%BC%88Custom-Types%EF%BC%89"><span class="toc-number">4.5.</span> <span class="toc-text">è‡ªå®šä¹‰ç±»å‹ï¼ˆCustom Typesï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88CRUD%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">æ•°æ®å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SELECT"><span class="toc-number">5.1.</span> <span class="toc-text">SELECT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Allowing-filtering"><span class="toc-number">5.1.1.</span> <span class="toc-text">Allowing filtering</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSERT"><span class="toc-number">5.2.</span> <span class="toc-text">INSERT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UPDATE"><span class="toc-number">5.3.</span> <span class="toc-text">UPDATE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DELETE"><span class="toc-number">5.4.</span> <span class="toc-text">DELETE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%B9%E5%A4%84%E7%90%86"><span class="toc-number">5.5.</span> <span class="toc-text">æ‰¹å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UNLOGGED-batches"><span class="toc-number">5.5.1.</span> <span class="toc-text">UNLOGGED batches</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#COUNTER-batches"><span class="toc-number">5.5.2.</span> <span class="toc-text">COUNTER batches</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90"><span class="toc-number">6.</span> <span class="toc-text">å‚è€ƒèµ„æº</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By gcdd1993</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="/js/tw_cn.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const t=()=>{new Gitalk(Object.assign({clientID:"a3de6c3335a73d1411e6",clientSecret:"93ce5186fda42733a3061c9ee5912c162de164fc",repo:"gcdd1993.github.io",owner:"gcdd1993",admin:["gcdd1993"],id:"61e17aac64ae8d30070622d460697f0f",updateCountCallback:n},null)).render("gitalk-container")},e=async()=>{"function"==typeof Gitalk||(await getCSS("https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css"),await getScript("https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js")),t()},n=t=>{const e=document.querySelector("#post-meta .gitalk-comment-count");e&&(e.textContent=t)};btf.loadComment(document.getElementById("gitalk-container"),e)})()</script></div><script>window.addEventListener("load",()=>{const e=()=>{fetch("https://api.github.com/repos/gcdd1993/gcdd1993.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1",{headers:{Accept:"application/vnd.github.v3.html+json"}}).then(e=>e.json()).then(e=>{const a=e.map(e=>{return{avatar:e.user.avatar_url,content:(t=e.body_html||e.body,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[å›¾ç‰‡]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[é“¾æ¥]")).replace(/<pre><code>.*?<\/pre>/gi,"[ä»£ç ]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),nick:e.user.login,url:e.issue_url,date:e.updated_at,githubUrl:e.html_url};var t});var n;n=a,Promise.all(n.map(e=>fetch(e.url).then(e=>e.json()).then(e=>{let t=e.body?e.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/gi):[];return Array.isArray(t)&&0!==t.length||(t=[""+e.html_url]),"utterances-bot"===e.user.login?t.pop():t.shift()}))).then(e=>{n=n.map((t,a)=>({...t,url:e[a]})),saveToLocal.set("github-newest-comments",JSON.stringify(n),10/1440),t(n)})}).catch(e=>{document.querySelector("#card-newest-comments .aside-list").textContent="æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"})},t=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}' title='${e[a].content}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="æ²¡æœ‰è¯„è®º";let a=document.querySelector("#card-newest-comments .aside-list");a&&(a.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},a=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const a=saveToLocal.get("github-newest-comments");a?t(JSON.parse(a)):e()}};a(),document.addEventListener("pjax:complete",a)})</script><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async mobile="false"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-DQJWXD2MFH",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.22.0/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.63.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js?v=4.12.0"></script></div></div></body></html>